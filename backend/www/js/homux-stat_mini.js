var req=null,reqHour=null,reqDay=null;var ll=null,ll_hour=null,ll_day=null;var ie=(window.navigator.userAgent.indexOf("MSIE")>-1?true:false);function dataGet() {var now=new Date();var dummy=now.getMonth()+now.getDay()+now.getHours()+now.getMinutes();var url="/serverreport/getData.html";loadproc("");req=initHttp();req.onreadystatechange=function() {if(req.readyState==4) {if(req.status==200) {try {ll=eval('('+req.responseText+')');dataWrite();}catch(e){if(ie) {vml_grid(vmlCon,vmlMsg);vmlCon.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >Connecntions (hour)</v:textbox>";vmlMsg.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >MessagesBitRate (hour)</v:textbox>";}else{if(connectCanvas.getContext) {grid(connectCtx,msgCtx);connectCtx.font=12+"px 'Verdana'";connectCtx.textAlign="center";connectCtx.fillStyle='rgb(0,0,0)';connectCtx.fillText("Connections (hour)",160,10);msgCtx.font=12+"px 'Verdana'";msgCtx.textAlign="center";msgCtx.fillStyle='rgb(0,0,0)';msgCtx.fillText("MessageBitsRate (hour)",160,10);}}setTimeout(dataGet,1000*60);}loadproc("off");}else{debug_write("Request Status:"+req.status);loadproc("off");setTimeout(dataGet,1000*60);}}};req.open("GET",url,true);req.send(null);}function dataGetHour() {var now=new Date();var dummy=now.getMonth()+now.getDay()+now.getHours()+now.getMinutes();var url="/serverreport/getDataHour.html";loadproc("");reqHour=initHttp();reqHour.onreadystatechange=function() {if(reqHour.readyState==4) {if(reqHour.status==200) {try {ll_hour=eval('('+reqHour.responseText+')');dataHourWrite();}catch(e){if(ie) {vml_grid(vmlConHour,vmlMsgHour);vmlConHour.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >Connecntions (day)</v:textbox>";vmlMsgHour.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >MessagesBitRate (day)</v:textbox>";}else{if(connectCanvas.getContext) {grid(connectCtxHour,msgCtxHour);connectCtxHour.font=12+"px 'Verdana'";connectCtxHour.textAlign="center";connectCtxHour.fillStyle='rgb(0,0,0)';connectCtxHour.fillText("Connections (day)",160,10);msgCtxHour.font=12+"px 'Verdana'";msgCtxHour.textAlign="center";msgCtxHour.fillStyle='rgb(0,0,0)';msgCtxHour.fillText("MessageBitsRate (day)",160,10);}}setTimeout(dataGetHour,1000*60*12);}loadproc("off");}else{debug_write("Request Status:"+reqHour.status);loadproc("off");setTimeout(dataGetHour,1000*60*12);}}};reqHour.open("GET",url,true);reqHour.send(null);}function dataGetDay() {var now=new Date();var dummy=now.getMonth()+now.getDay()+now.getHours()+now.getMinutes();var url="/serverreport/getDataDay.html";loadproc("");reqDay=initHttp();reqDay.onreadystatechange=function() {if(reqDay.readyState==4) {if(reqDay.status==200) {try {ll_day=eval('('+reqDay.responseText+')');dataDayWrite();}catch(e){if(ie) {vml_grid(vmlConDay,vmlMsgDay);vmlConDay.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >Connecntions (month)</v:textbox>";vmlMsgDay.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >MessagesBitRate (month)</v:textbox>";}else{if(connectCanvas.getContext) {grid(connectCtxDay,msgCtxDay);connectCtxDay.font=12+"px 'Verdana'";connectCtxDay.textAlign="center";connectCtxDay.fillStyle='rgb(0,0,0)';connectCtxDay.fillText("Connections (month)",160,10);msgCtxDay.font=12+"px 'Verdana'";msgCtxDay.textAlign="center";msgCtxDay.fillStyle='rgb(0,0,0)';msgCtxDay.fillText("MessageBitsRate (month)",160,10);}}setTimeout(dataGetHour,1000*60*60*3);}loadproc("off");}else{debug_write("Request Status:"+reqDay.status);loadproc("off");setTimeout(dataGetHour,1000*60*60*3);}}};reqDay.open("GET",url,true);reqDay.send(null);}var connectCanvas=null;var msgCanvas=null;var connectCtx=null;var msgCtx=null;var connectCanvasHour,msgCanvasHour,connectCanvasDay,msgCanvasDay;var connectCtxHour,msgCtxHour,connectCtxDay,msgCtxDay;var cnt=0;var vmlCon,vmlMsg,vmlConHour,vmlMsgHour,vmlConDay,vmlMsgDay;var versionString="homux-serverstat ver 0.51<br />comjakma@paran.com";function dataWrite() {var oCon=$("rt");var DateTime,CurConnect;var MessagesInBytesRate,MessagesOutBytesRate;var listTableElem,listTbodyElem,listNewTbodyElem;$("TotConnect").innerHTML=formatShort(ll.ConnectionsTotal);$("CurConnect").innerHTML=formatShort(ll.ConnectionsCurrent);$("TotAccept").innerHTML=formatShort(ll.ConnectionsTotalAccepted);$("TotReject").innerHTML=formatShort(ll.ConnectionsTotalRejected);$("CurMsgIn").innerHTML=formatBit(ll.MessagesInBytesRate);$("CurMsgOut").innerHTML=formatBit(ll.MessagesOutBytesRate);try {if(ie) {drawVml(vmlCon,vmlMsg,ll,1);vmlCon.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >Connecntions (hour)</v:textbox>";vmlMsg.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >MessagesBitRate (hour)</v:textbox>";}else{if(connectCanvas.getContext) {drawGraph(connectCtx,msgCtx,ll,1);connectCtx.font=12+"px 'Verdana'";connectCtx.textAlign="center";connectCtx.fillStyle='rgb(0,0,0)';connectCtx.fillText("Connections (hour)",160,10);msgCtx.font=12+"px 'Verdana'";msgCtx.textAlign="center";msgCtx.fillStyle='rgb(0,0,0)';msgCtx.fillText("MessageBitsRate (hour)",160,10);}}}catch(e){debug_write(e);}if($("detailViewChk").checked) {listTableElem=document.getElementById("list_table");listTbodyElem=document.getElementById("list_tbody");listNewTbodyElem=document.createElement("tbody");listNewTbodyElem.setAttribute("id","list_tbody");var docFragment=document.createDocumentFragment();var trElem,tdElem,imgNode,txtNode,hrefNode,brNode,btnElem;var btn_bgcolor,text_color;for(i=0;i<ll.list.length-1;i++) {DateTime=ll.list[i].StatDateTime;CurConnect=Math.round(ll.list[i].CurConnections);MessagesInBytesRate=ll.list[i].MessagesInBytesRate;MessagesOutBytesRate=ll.list[i].MessagesOutBytesRate;trElem=$c("tr");trElem.setAttribute("id",DateTime);trElem.style.cssText=(i%2==0)?"background-color:#fffbf3;height:20px;":"background-color:#ffffff;height:20px;";insertTextTd(trElem,DateTime,"center");insertTextTd(trElem,CurConnect,"center","");insertTextTd(trElem,formatBit(MessagesInBytesRate),"center","");insertTextTd(trElem,formatBit(MessagesOutBytesRate),"center","");docFragment.appendChild(trElem);}listNewTbodyElem.appendChild(docFragment);listTableElem.replaceChild(listNewTbodyElem,listTbodyElem);}loadproc("off");setTimeout(dataGet,1000*60);}function dataHourWrite() {try {if(ie) {drawVml(vmlConHour,vmlMsgHour,ll_hour,2);vmlConHour.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >Connecntions (day)</v:textbox>";vmlMsgHour.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >MessagesBitRate (day)</v:textbox>";}else{if(connectCanvas.getContext) {drawGraph(connectCtxHour,msgCtxHour,ll_hour,2);connectCtxHour.font=12+"px 'Verdana'";connectCtxHour.textAlign="center";connectCtxHour.fillStyle='rgb(0,0,0)';connectCtxHour.fillText("Connections (day)",160,10);msgCtxHour.font=12+"px 'Verdana'";msgCtxHour.textAlign="center";msgCtxHour.fillStyle='rgb(0,0,0)';msgCtxHour.fillText("MessageBitsRate (day)",160,10);}}}catch(e){debug_write(e);}loadproc("off");setTimeout(dataGetHour,1000*60*12);}function dataDayWrite() {try {if(ie) {drawVml(vmlConDay,vmlMsgDay,ll_day,4);vmlConDay.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >Connecntions (month)</v:textbox>";vmlMsgDay.innerHTML+="<v:textbox style=\"position:absolute; color:#000; font-size:12px; width:200px; top:0px; left:60px; text-align:center;\" >MessagesBitRate (month)</v:textbox>";}else{if(connectCanvas.getContext) {drawGraph(connectCtxDay,msgCtxDay,ll_day,4);connectCtxDay.font=12+"px 'Verdana'";connectCtxDay.textAlign="center";connectCtxDay.fillStyle='rgb(0,0,0)';connectCtxDay.fillText("Connections (month)",160,10);msgCtxDay.font=12+"px 'Verdana'";msgCtxDay.textAlign="center";msgCtxDay.fillStyle='rgb(0,0,0)';msgCtxDay.fillText("MessageBitsRate (month)",160,10);}}}catch(e){debug_write(e);}loadproc("off");setTimeout(dataGetHour,1000*60*60*3);}function drawGraph(con,msg,ls,cycle) {var MaxConDigit=0;var MaxMsgDigit=0;getMaxHeight(ls);MaxConDigit=MaxConnect.toString().length-2;MaxMsgDigit=(getBitNum(MaxInBytes).length>getBitNum(MaxOutBytes).length?getBitNum(MaxInBytes).length-2:getBitNum(MaxOutBytes).length-2);if(connectCanvas.getContext) {con.clearRect(0,0,290,160);msg.clearRect(0,0,290,160);grid(con,msg);con.textAlign="start";msg.textAlign="start";con.fillStyle='rgb(0,0,0)';msg.fillStyle='rgb(0,0,0)';con.font=9+"px 'Arial'";msg.font=9+"px 'Arial'";for(i=0;i<ls.list.length;i++) {if(i%(12*cycle)==0) {con.fillText((ls.list[i].StatDateTime.length>10?ls.list[i].StatDateTime.substring(11,16) :ls.list[i].StatDateTime.substring(5,10)),28+240-(48*i/(12*cycle)),132);msg.fillText((ls.list[i].StatDateTime.length>10?ls.list[i].StatDateTime.substring(11,16) :ls.list[i].StatDateTime.substring(5,10)),28+240-(48*i/(12*cycle)),132);}}maxConBound=(Math.round(MaxConnect/square(10,MaxConDigit))/50>1?1:2);maxMaxBound=((MaxOutBytes>MaxInBytes?Math.round(getBitNum(MaxOutBytes)/square(10,MaxMsgDigit)):Math.round(getBitNum(MaxInBytes)/square(10,MaxMsgDigit)))/50>1?1:2);con.textAlign="end";con.fillText(formatShort(square(10,MaxConDigit)*100/maxConBound),38,28);con.fillText(formatShort(square(10,MaxConDigit)*50/maxConBound),38,75);msg.textAlign="end";msg.fillText(formatShort(100*square(10,MaxMsgDigit)/maxMaxBound),38,28);msg.fillText(formatShort(50*square(10,MaxMsgDigit)/maxMaxBound),38,75);msg.textAlign="start";msg.fillText("In",84,150);msg.fillText("Out",164,150);msg.strokeStyle='rgba(255,0,0,0.6)';msg.beginPath();msg.moveTo(40,147);msg.lineTo(80,147);msg.stroke();msg.strokeStyle='rgba(0,205,0,0.6)';msg.beginPath();msg.moveTo(120,147);msg.lineTo(160,147);msg.stroke();con.strokeStyle='rgba(0,0,255,0.6)';con.beginPath();msg.strokeStyle='rgba(255,0,0,0.6)';msg.beginPath();for(i=0;i<ls.list.length;i++) {if(i==0) {con.moveTo(280-i*(4/cycle),(119-Math.round(maxConBound*ls.list[i].CurConnections/square(10,MaxConDigit))));msg.moveTo(280-i*(4/cycle),(119-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesInBytesRate)/square(10,MaxMsgDigit))));}else{con.lineTo(280-i*(4/cycle),(119-Math.round(maxConBound*ls.list[i].CurConnections/square(10,MaxConDigit))));msg.lineTo(280-i*(4/cycle),(119-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesInBytesRate)/square(10,MaxMsgDigit))));}}con.stroke();msg.stroke();msg.strokeStyle='rgba(0,204,0,0.6)';msg.beginPath();for(i=0;i<ls.list.length;i++) {if(i==0) {msg.moveTo(280-i*(4/cycle),(119-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesOutBytesRate)/square(10,MaxMsgDigit))));}else{msg.lineTo(280-i*(4/cycle),(119-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesOutBytesRate)/square(10,MaxMsgDigit))));}}msg.stroke();}}function drawVml(conVml,msgVml,ls,cycle) {var MaxConDigit=0;var MaxMsgDigit=0;var conString="",msgString="";var conPath="",msgInPath="",msgOutPath="";getMaxHeight(ls);MaxConDigit=MaxConnect.toString().length-2;MaxMsgDigit=(getBitNum(MaxInBytes).length>getBitNum(MaxOutBytes).length?getBitNum(MaxInBytes).length-2:getBitNum(MaxOutBytes).length-2);vml_grid(conVml,msgVml);for(i=0;i<ls.list.length;i++) {if(i%(12*cycle)==0) {conString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; width:38px; top:120px; left:"+(24+240-(48*i/(12*cycle)))+"px;\" >"+(ls.list[i].StatDateTime.length>10?ls.list[i].StatDateTime.substring(11,16) :ls.list[i].StatDateTime.substring(5,10))+"</v:textbox>";msgString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; width:38px; top:120px; left:"+(24+240-(48*i/(12*cycle)))+"px;\" >"+(ls.list[i].StatDateTime.length>10?ls.list[i].StatDateTime.substring(11,16) :ls.list[i].StatDateTime.substring(5,10))+"</v:textbox>";}}maxConBound=(Math.round(MaxConnect/square(10,MaxConDigit))/50>1?1:2);maxMaxBound=((MaxOutBytes>MaxInBytes?Math.round(getBitNum(MaxOutBytes)/square(10,MaxMsgDigit)):Math.round(getBitNum(MaxInBytes)/square(10,MaxMsgDigit)))/50>1?1:2);conString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; top:12px; left:4px; width:38px; text-align:right;\" >"+formatShort(square(10,MaxConDigit)*100/maxConBound) +"</v:textbox>";conString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; top:60px; left:4px; width:38px; text-align:right;\" >"+formatShort(square(10,MaxConDigit)*50/maxConBound) +"</v:textbox>";msgString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; top:12px; left:4px; width:38px; text-align:right;\" >"+formatShort(100*square(10,MaxMsgDigit)/maxMaxBound) +"</v:textbox>";msgString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; top:60px; left:4px; width:38px; text-align:right;\" >"+formatShort(50*square(10,MaxMsgDigit)/maxMaxBound) +"</v:textbox>";msgString+="<v:line style=\"position:absolute; top:0px; left:0px;\"  from=\"40px,146px\" to=\"80px,146px\" strokecolor=\"#ff0000\" strokeweight=\"2px\" />";msgString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; width:38px; top:136px; left:84px;\" >In</v:textbox>";msgString+="<v:line style=\"position:absolute; top:0px; left:0px;\"  from=\"120px,146px\" to=\"160px,146px\" strokecolor=\"#00cc00\" strokeweight=\"2px\" />";msgString+="<v:textbox style=\"position:absolute; color:#000; font-size:9px; width:38px; top:136px; left:164px;\" >Out</v:textbox>";for(i=0;i<ls.list.length;i++) {if(i==0) {conPath+=("m "+(240-i*(4/cycle))+","+(100-Math.round(maxConBound*ls.list[i].CurConnections/square(10,MaxConDigit)))+" l ");msgInPath+=("m "+(240-i*(4/cycle))+","+(99-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesInBytesRate)/square(10,MaxMsgDigit)))+" l ");msgOutPath+=("m "+(240-i*(4/cycle))+","+(99-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesOutBytesRate)/square(10,MaxMsgDigit)))+" l ");}else{conPath+=(" "+(240-i*(4/cycle))+","+(100-Math.round(maxConBound*ls.list[i].CurConnections/square(10,MaxConDigit)))+", ");msgInPath+=(" "+(240-i*(4/cycle))+","+(99-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesInBytesRate)/square(10,MaxMsgDigit)))+", ");msgOutPath+=(" "+(240-i*(4/cycle))+","+(99-Math.round(maxMaxBound*getBitNum(ls.list[i].MessagesOutBytesRate)/square(10,MaxMsgDigit)))+", ");}}conPath=conPath.substring(0,conPath.length-2);msgInPath=msgInPath.substring(0,msgInPath.length-2);msgOutPath=msgOutPath.substring(0,msgOutPath.length-2);conString+="<v:shape style=\"position:absolute; top:20px; left:40px; width:240px; height:100px;\" strokecolor=\"#0000ff\" path=\""+conPath+" e \" strokeweight=\"2px\" filled=\"false\" coordorigin=\"0 0\" coordsize=\"240 100\" />";msgString+="<v:shape style=\"position:absolute; top:20px; left:40px; width:240px; height:100px;\" strokecolor=\"#ff0000\" path=\""+msgInPath+" e \" strokeweight=\"2px\" filled=\"false\" coordorigin=\"0 0\" coordsize=\"240 100\" />";msgString+="<v:shape style=\"position:absolute; top:20px; left:40px; width:240px; height:100px;\" strokecolor=\"#00cc00\" path=\""+msgOutPath+" e \" strokeweight=\"2px\" filled=\"false\" coordorigin=\"0 0\" coordsize=\"240 100\" />";conVml.innerHTML+=conString;msgVml.innerHTML+=msgString;}var MaxConnect=0;var MaxInBytes=0;var MaxOutBytes=0;function getMaxHeight(ls) {MaxConnect=0;MaxInBytes=0;MaxOutBytes=0;for(i=0;i<ls.list.length;i++) {if(Math.round(ls.list[i].CurConnections)>MaxConnect) MaxConnect=Math.round(ls.list[i].CurConnections);if(Math.round(ls.list[i].MessagesInBytesRate)>MaxInBytes) MaxInBytes=Math.round(ls.list[i].MessagesInBytesRate);if(Math.round(ls.list[i].MessagesOutBytesRate)>MaxOutBytes) MaxOutBytes=Math.round(ls.list[i].MessagesOutBytesRate);}}function square(num,cnt) {var ret=(cnt>=0?1:0.1);for(k=0; k<cnt; k++) {if(cnt>=0) {ret *=num;}else{ret /=num;}}return ret;}function loadproc(opt) {var loading=$("loading");if(opt=="") {loading.style.display="";loading.style.pixelTop=document.body.clientHeight/2-32;loading.style.pixelLeft=document.body.clientWidth/2-16;}else{loading.style.display="none";}}function getBitNum(bytes) {var bits=(bytes=="0.0"?0:bytes*8);var ret="0";ret=Math.round(bits)+"";return ret;}function formatBit(bytes) {var bits=(bytes=="0.0"?0:bytes*8);var ret="0";if(bits>=1024 && bits>0) {if(bits>=(1024*1024*1024)) {ret=Math.round(bits/(1024.0*1024.0*1024.0)*10)/10.0+"G";} else if(bits>=(1024*1024)) {ret=Math.round(bits/(1024.0*1024.0)*10)/10.0+"M";}else{ret=Math.round(bits/(1024.0)*10)/10.0+"K";}if(ret=="1000K") ret="1M";if(ret=="1000M") ret="1G";if(ret=="1000G") ret="1T";}else{ret=bits+"";}return ret;}function formatShort(num) {var ret="0";if(num>=1000 && num>0) {if(num>=(1000*1000*1000)) {ret=Math.round(num/(1000.0*1000.0*1000.0)*10)/10.0+" G";} else if(num>=(1000*1000)) {ret=Math.round(num/(1000.0*1000.0)*10)/10.0+" M";}else{ret=Math.round(num/(1000.0)*10)/10.0+" K";}if(ret=="1000 K") ret="1 M";if(ret=="1000 M") ret="1 G";if(ret=="1000 G") ret="1 T";}else{ret=num+"";}return ret;}function debug_write(msg) {var el=$("debug");el.innerHTML=msg.replace("<","&lt;")+"<br />"+el.innerHTML;}function chkTbl() {var el=$("list_table");if(!$("detailViewChk").checked) {el.style.display="none";}else{el.style.display="";setTimeout(dataGet,500);}}function canvasInit() {connectCanvas=$("connectGraph");msgCanvas=$("messageGraph");connectCanvasHour=$("connectGraphHour");msgCanvasHour=$("messageGraphHour");connectCanvasDay=$("connectGraphDay");msgCanvasDay=$("messageGraphDay");vmlCon=$("vmlConGraph");vmlMsg=$("vmlMsgGraph");vmlConHour=$("vmlConGraphHour");vmlMsgHour=$("vmlMsgGraphHour");vmlConDay=$("vmlConGraphDay");vmlMsgDay=$("vmlMsgGraphDay");if(connectCanvas.getContext) {connectCtx=connectCanvas.getContext('2d');connectCtx.scale(1,1);msgCtx=msgCanvas.getContext('2d');msgCtx.scale(1,1);connectCtxHour=connectCanvasHour.getContext('2d');connectCtxHour.scale(1,1);msgCtxHour=msgCanvasHour.getContext('2d');msgCtxHour.scale(1,1);connectCtxDay=connectCanvasDay.getContext('2d');connectCtxDay.scale(1,1);msgCtxDay=msgCanvasDay.getContext('2d');msgCtxDay.scale(1,1);}}function grid(con,msg) {con.strokeStyle='rgb(140,140,140)';con.fillStyle='rgb(140,140,140)';con.lineWidth=1;con.strokeRect(40,20,240,100);msg.strokeStyle='rgb(140,140,140)';msg.fillStyle='rgb(140,140,140)';msg.lineWidth=1;msg.strokeRect(40,20,240,100);con.strokeStyle='rgb(239,239,239)';con.lineWidth=1;msg.strokeStyle='rgb(239,239,239)';msg.lineWidth=1;for(i=1; i < 10; i++) {con.beginPath();con.moveTo(24*i+40,120);con.lineTo(24*i+40,20);con.stroke();con.beginPath();con.moveTo(40,i*10+20);con.lineTo(280,i*10+20);con.stroke();msg.beginPath();msg.moveTo(24*i+40,120);msg.lineTo(24*i+40,20);msg.stroke();msg.beginPath();msg.moveTo(40,i*10+20);msg.lineTo(280,i*10+20);msg.stroke();}con.strokeStyle='rgb(0,0,255)';con.lineWidth=2;msg.strokeStyle='rgb(0,204,0)';msg.lineWidth=2;}function vml_grid(c,m) {var shapeString="";shapeString+="<v:rect style=\"position:absolute; top:20px; left:40px; width:240px; height:100px; margin:0; padding:0;\" filled=\"false\" strokecolor=\"#8C8C8C\" strokeweight=\"1pt\" />";for(i=1; i < 10; i++) {shapeString+="<v:line style=\"position:absolute; top:0px; left:0px;\"  from=\""+(24*i+40)+"px,120px\" to=\""+(24*i+40)+"px,20px\" strokecolor=\"#EFEFEF\" strokeweight=\"1px\" />";shapeString+="<v:line style=\"position:absolute; top:0px; left:0px;\"  from=\"40px,"+(i*10+20)+"px\" to=\"280px,"+(i*10+20)+"px\" strokecolor=\"#EFEFEF\" strokeweight=\"1px\" />";}c.innerHTML=shapeString;m.innerHTML=shapeString;}window.onload=function() {$("ver").innerHTML=versionString;canvasInit();setTimeout(dataGet,500);setTimeout(dataGetHour,600);setTimeout(dataGetDay,700);}
